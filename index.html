<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deep Linking Example</title>
</head>
<body>
    <button id="openLink">Open Daraz App</button>

    <script>
        // Deep link for Daraz app
        var appDeepLink = 'daraz://s.daraz.pk/s.ZrybM?cc';  // Custom deep link scheme for the Daraz app
        var fallbackUrl = 'https://s.daraz.pk/s.ZrybM?cc';   // URL to open in the browser

        // Timeout variable for deep link fallback
        var timeout;

        // Force open in external browser, not in-app browser (like Instagram's browser)
        function openInExternalBrowser(url) {
            var isIos = /iPhone|iPad|iPod/i.test(navigator.userAgent);
            var isAndroid = /Android/i.test(navigator.userAgent);
            
            // Open in a new window or tab
            window.open(url, '_blank');
        }

        // Handle the button click
        document.getElementById('openLink').addEventListener('click', function() {
            // First, open the fallback URL in an external browser (this will be the browser itself or the Instagram app's external browser)
            openInExternalBrowser(fallbackUrl);

            // After a delay, try to open the Daraz app using deep linking
            timeout = setTimeout(function() {
                // Attempt to open the app
                window.location = appDeepLink;
            }, 2000); // Delay time before falling back to the app (2 seconds)

            // Check if the user is on mobile
            if (navigator.userAgent.match(/(iPhone|iPod|iPad|Android)/)) {
                // You can add additional checks here for platform-specific logic, but generally, the fallback approach is sufficient.
            }
        });

        // Force the page to open in an external browser initially
        if (navigator.userAgent.match(/(iPhone|iPod|iPad|Android)/)) {
            openInExternalBrowser(fallbackUrl); // Open the fallback URL (browser)
        }
    </script>
</body>
</html>
